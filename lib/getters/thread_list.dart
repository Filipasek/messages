import 'dart:convert';
// import 'package:shared_preferences/shared_preferences.dart';

import '../models/user_model.dart';
import 'package:http/http.dart' as http;

// _read() async {
//     final prefs = await SharedPreferences.getInstance();
//     final key = 'my_credentials_key';
//     final value = prefs.getString(key) ?? 0;
//     // print('read: $value');
//     return value;
//   }

Future<ThreadList> getThreadList() async {
  print("here");
  final credentials = '[{"key":"fr","value":"1edeDVrOFvG0CGyrF.AWV6Wl7AXhmbivSGyRQdOqe20yw.BemJrG.-V.AAA.0.0.BemJrH.AWVlcP-F","expires":"2020-07-15T17:49:57.000Z","maxAge":7775998,"domain":"facebook.com","path":"/","secure":true,"httpOnly":true,"hostOnly":false,"creation":"2020-04-16T17:49:59.074Z","lastAccessed":"2020-04-16T17:50:02.324Z"},{"key":"sb","value":"xpqYXn4TNc1ryBZ285TipHwV","expires":"2022-04-16T17:49:59.000Z","maxAge":63072000,"domain":"facebook.com","path":"/","secure":true,"httpOnly":true,"hostOnly":false,"creation":"2020-04-16T17:49:59.077Z","lastAccessed":"2020-04-16T17:50:02.324Z"},{"key":"datr","value":"xpqYXuAlM1PGckmUPaN7-gUi","domain":"facebook.com","path":"/","hostOnly":false,"creation":"2020-04-16T17:49:59.220Z","lastAccessed":"2020-04-16T17:50:02.324Z"},{"key":"c_user","value":"100050369465109","expires":"2021-04-16T17:49:58.000Z","maxAge":31535999,"domain":"facebook.com","path":"/","secure":true,"hostOnly":false,"creation":"2020-04-16T17:49:59.892Z","lastAccessed":"2020-04-16T17:50:02.324Z"},{"key":"xs","value":"30%3AQ4AzafJ9qaMubA%3A2%3A1587059399%3A-1%3A-1","expires":"2021-04-16T17:49:58.000Z","maxAge":31535999,"domain":"facebook.com","path":"/","secure":true,"httpOnly":true,"hostOnly":false,"creation":"2020-04-16T17:49:59.893Z","lastAccessed":"2020-04-16T17:50:02.324Z"},{"key":"spin","value":"r.1001998448_b.trunk_t.1587059399_s.1_v.2_","expires":"2020-04-17T18:49:59.000Z","maxAge":90000,"domain":"facebook.com","path":"/","secure":true,"httpOnly":true,"hostOnly":false,"creation":"2020-04-16T17:49:59.983Z","lastAccessed":"2020-04-16T17:50:02.324Z"},{"key":"presence","value":"EDvF3EtimeF1587059402EuserFA21B50369465109A2EstateFDutF0Et2F_5b_5dElm2FnullEuct2F1587059402296EtrFnullEtwF3899607016EatF1587059402296CEchFDp_5f1B50369465109F0CC","domain":"facebook.com","path":"/","secure":true,"hostOnly":false,"creation":"2020-04-16T17:50:02.297Z","lastAccessed":"2020-04-16T17:50:02.324Z"},{"key":"locale","value":"en_US","domain":"facebook.com","path":"/","secure":true,"hostOnly":false,"creation":"2020-04-16T17:50:02.304Z","lastAccessed":"2020-04-16T17:50:02.324Z"},{"key":"a11y","value":"%7B%22sr%22%3A0%2C%22sr-ts%22%3A1587059402318%2C%22jk%22%3A0%2C%22jk-ts%22%3A1587059402318%2C%22kb%22%3A0%2C%22kb-ts%22%3A1587059402318%2C%22hcm%22%3A0%2C%22hcm-ts%22%3A1587059402318%7D","domain":"facebook.com","path":"/","secure":true,"hostOnly":false,"creation":"2020-04-16T17:50:02.318Z","lastAccessed":"2020-04-16T17:50:02.324Z"},{"key":"fr","value":"1edeDVrOFvG0CGyrF.AWV6Wl7AXhmbivSGyRQdOqe20yw.BemJrG.-V.AAA.0.0.BemJrH.AWVlcP-F","expires":"2020-07-15T17:49:57.000Z","maxAge":7775998,"domain":"facebook.com","path":"/","secure":true,"httpOnly":true,"hostOnly":false,"creation":"2020-04-16T17:49:59.074Z","lastAccessed":"2020-04-16T17:50:02.324Z"},{"key":"sb","value":"xpqYXn4TNc1ryBZ285TipHwV","expires":"2022-04-16T17:49:59.000Z","maxAge":63072000,"domain":"facebook.com","path":"/","secure":true,"httpOnly":true,"hostOnly":false,"creation":"2020-04-16T17:49:59.077Z","lastAccessed":"2020-04-16T17:50:02.324Z"},{"key":"datr","value":"xpqYXuAlM1PGckmUPaN7-gUi","domain":"facebook.com","path":"/","hostOnly":false,"creation":"2020-04-16T17:49:59.220Z","lastAccessed":"2020-04-16T17:50:02.324Z"},{"key":"c_user","value":"100050369465109","expires":"2021-04-16T17:49:58.000Z","maxAge":31535999,"domain":"facebook.com","path":"/","secure":true,"hostOnly":false,"creation":"2020-04-16T17:49:59.892Z","lastAccessed":"2020-04-16T17:50:02.324Z"},{"key":"xs","value":"30%3AQ4AzafJ9qaMubA%3A2%3A1587059399%3A-1%3A-1","expires":"2021-04-16T17:49:58.000Z","maxAge":31535999,"domain":"facebook.com","path":"/","secure":true,"httpOnly":true,"hostOnly":false,"creation":"2020-04-16T17:49:59.893Z","lastAccessed":"2020-04-16T17:50:02.324Z"},{"key":"spin","value":"r.1001998448_b.trunk_t.1587059399_s.1_v.2_","expires":"2020-04-17T18:49:59.000Z","maxAge":90000,"domain":"facebook.com","path":"/","secure":true,"httpOnly":true,"hostOnly":false,"creation":"2020-04-16T17:49:59.983Z","lastAccessed":"2020-04-16T17:50:02.324Z"},{"key":"presence","value":"EDvF3EtimeF1587059402EuserFA21B50369465109A2EstateFDutF0Et2F_5b_5dElm2FnullEuct2F1587059402296EtrFnullEtwF3899607016EatF1587059402296CEchFDp_5f1B50369465109F0CC","domain":"facebook.com","path":"/","secure":true,"hostOnly":false,"creation":"2020-04-16T17:50:02.297Z","lastAccessed":"2020-04-16T17:50:02.324Z"},{"key":"locale","value":"en_US","domain":"facebook.com","path":"/","secure":true,"hostOnly":false,"creation":"2020-04-16T17:50:02.304Z","lastAccessed":"2020-04-16T17:50:02.324Z"},{"key":"a11y","value":"%7B%22sr%22%3A0%2C%22sr-ts%22%3A1587059402318%2C%22jk%22%3A0%2C%22jk-ts%22%3A1587059402318%2C%22kb%22%3A0%2C%22kb-ts%22%3A1587059402318%2C%22hcm%22%3A0%2C%22hcm-ts%22%3A1587059402318%7D","domain":"facebook.com","path":"/","secure":true,"hostOnly":false,"creation":"2020-04-16T17:50:02.318Z","lastAccessed":"2020-04-16T17:50:02.324Z"},{"key":"fr","value":"1edeDVrOFvG0CGyrF.AWV6Wl7AXhmbivSGyRQdOqe20yw.BemJrG.-V.AAA.0.0.BemJrH.AWVlcP-F","expires":"2020-07-15T17:49:57.000Z","maxAge":7775998,"domain":"messenger.com","path":"/","secure":true,"httpOnly":true,"hostOnly":false,"creation":"2020-04-16T17:49:59.076Z","lastAccessed":"2020-04-16T17:50:02.329Z"},{"key":"sb","value":"xpqYXn4TNc1ryBZ285TipHwV","expires":"2022-04-16T17:49:59.000Z","maxAge":63072000,"domain":"messenger.com","path":"/","secure":true,"httpOnly":true,"hostOnly":false,"creation":"2020-04-16T17:49:59.079Z","lastAccessed":"2020-04-16T17:50:02.329Z"},{"key":"c_user","value":"100050369465109","expires":"2021-04-16T17:49:58.000Z","maxAge":31535999,"domain":"messenger.com","path":"/","secure":true,"hostOnly":false,"creation":"2020-04-16T17:49:59.912Z","lastAccessed":"2020-04-16T17:50:02.329Z"},{"key":"xs","value":"30%3AQ4AzafJ9qaMubA%3A2%3A1587059399%3A-1%3A-1","expires":"2021-04-16T17:49:58.000Z","maxAge":31535999,"domain":"messenger.com","path":"/","secure":true,"httpOnly":true,"hostOnly":false,"creation":"2020-04-16T17:49:59.915Z","lastAccessed":"2020-04-16T17:50:02.329Z"},{"key":"spin","value":"r.1001998448_b.trunk_t.1587059399_s.1_v.2_","expires":"2020-04-17T18:49:59.000Z","maxAge":90000,"domain":"messenger.com","path":"/","secure":true,"httpOnly":true,"hostOnly":false,"creation":"2020-04-16T17:50:01.067Z","lastAccessed":"2020-04-16T17:50:02.329Z"},{"key":"presence","value":"EDvF3EtimeF1587059402EuserFA21B50369465109A2EstateFDutF0Et2F_5b_5dElm2FnullEuct2F1587059402296EtrFnullEtwF3899607016EatF1587059402296CEchFDp_5f1B50369465109F0CC","domain":"messenger.com","path":"/","secure":true,"hostOnly":false,"creation":"2020-04-16T17:50:02.302Z","lastAccessed":"2020-04-16T17:50:02.329Z"},{"key":"locale","value":"en_US","domain":"messenger.com","path":"/","secure":true,"hostOnly":false,"creation":"2020-04-16T17:50:02.316Z","lastAccessed":"2020-04-16T17:50:02.329Z"}]';

  final response = await http.get(
    'https://messages-server.glitch.me/threadList',
    headers: {
      "JSON-Credentials":
          credentials,
    },
  );
  if (response.statusCode == 200) {
  print("here 22");

    ThreadList list = new ThreadList.fromJson(json.decode(response.body));

    return list;
  } else {
    throw Exception('Failed to load the Thread List!');
  }
}
